import{a as D,t as O}from"../chunks/disclose-version.BcrADR9R.js";import{i as yt}from"../chunks/legacy.Djsqqv72.js";import{v as _t,G as ot,aq as bt,H as wt,p as dt,b as Ct,B,ar as xt,a as vt,as as Wt,h as l,c as v,s as g,r as u,t as z,k as St,at as Mt,au as At,f as zt,av as U}from"../chunks/runtime.CVBxA8KQ.js";import{e as E,h as Pt,a as S}from"../chunks/store.Pu58CD8F.js";import{p as kt,b as Rt,a as T,i as Bt}from"../chunks/props.DYNU9CzF.js";function Et(i,t,a,s){var n=i.__attributes??(i.__attributes={});_t&&(n[t]=i.getAttribute(t)),n[t]!==(n[t]=a)&&("__styles"in i&&(i.__styles={}),a==null?i.removeAttribute(t):typeof a!="string"&&Ht(i).includes(t)?i[t]=a:i.setAttribute(t,a))}var st=new Map;function Ht(i){var t=st.get(i.nodeName);if(t)return t;st.set(i.nodeName,t=[]);for(var a,s=ot(i),n=Element.prototype;n!==s;){a=bt(s);for(var c in a)a[c].set&&t.push(c);s=ot(s)}return t}function lt(i,t){var c;var a=(c=i.$$events)==null?void 0:c[t.type],s=wt(a)?a.slice():a==null?[]:[a];for(var n of s)n.call(this,t)}function Vt(i,t={}){const{numberOfBuckets:a=600,channel:s=0}=t;if(s>=i.numberOfChannels)throw new Error(`Channel ${s} does not exist in audio buffer`);const n=i.getChannelData(s),c=Math.floor(n.length/a),y=[];for(let b=0;b<a;b++){const w=b*c,C=w+c;let M=0;for(let A=w;A<C;A++){const x=Math.abs(n[A]);x>M&&(M=x)}y.push(M/2)}return y}async function Lt(i){const t=new AudioContext;console.log(i);const a=await i.arrayBuffer();return await t.decodeAudioData(a)}function R(i){if(!isFinite(i)||i<0)return"00:00";const t=Math.floor(i/3600),a=Math.floor(i%3600/60),s=Math.floor(i%60),n=t>0?String(a).padStart(2,"0"):String(a),c=String(s).padStart(2,"0");return t>0?`${t}:${n}:${c}`:`${n}:${c}`}var Gt=O("<canvas></canvas>");function ct(i,t){dt(t,!0);let a,s=Wt(1);const n=(o,d,e)=>{if(!e||!a)return;const r=a.getContext("2d");if(!r)return;const P=Math.round(o/l(s)),h=Math.round(d/l(s));r.canvas.width=o,r.canvas.height=d,r.canvas.style.width=`${P}px`,r.canvas.style.height=`${h}px`,M(r,o,d),t.barWidth?w(r,o,e):C(r,o,e)};Ct(()=>{B(s,kt(window.devicePixelRatio||screen.deviceXDPI/screen.logicalXDPI)),n(t.canvasWidth,t.canvasHeight,t.peaks)});const c=o=>{let d=-1/0;for(const e in o){const r=Math.abs(o[e]);r>d&&(d=r)}return d},y=o=>Math.max(...o),b=o=>Math.min(...o),w=(o,d,e)=>{const r={fillParent:!0,height:t.canvasHeight,normalize:!0,pixelRatio:l(s),barWidth:t.barWidth,color:t.color,gradientColors:t.gradientColors};if(e.some(m=>m<0)){let m=e[0]<0?1:0;e=e.filter((W,L)=>(L+m)%2==0)}const h=.5/r.pixelRatio,_=r.height/2,k=r.barWidth*r.pixelRatio,H=Math.max(r.pixelRatio,2),V=k+H,f=c(e),p=e.length/d;if(r.gradientColors.length>0){const m=o.createLinearGradient(0,0,t.canvasWidth,0);r.gradientColors.forEach((W,L)=>{const G=L/(r.gradientColors.length-1);m.addColorStop(G,W)}),o.fillStyle=m}else o.fillStyle=r.color;for(let m=0;m<d;m+=V){let W=Math.round(e[Math.floor(m*p)]/f*_);W===0&&(W=1),o.fillRect(m+h,_-W,k+h,W*2)}},C=(o,d,e)=>{const r={fillParent:!0,height:t.canvasHeight,normalize:!0,pixelRatio:l(s),color:t.color,gradientColors:t.gradientColors};if(!e.some(f=>f<0)){const f=[];for(let p=0;p<e.length;(p+=1)-1)f[2*p]=e[p],f[2*p+1]=-e[p];e=f}const h=.5/r.pixelRatio,_=r.height/2,k=~~(e.length/2),H=d!=k?d/k:1,V=Math.max(y(e),-b(e));if(r.gradientColors.length>0){const f=o.createLinearGradient(0,0,t.canvasWidth,0);r.gradientColors.forEach((p,m)=>{const W=m/(r.gradientColors.length-1);f.addColorStop(W,p)}),o.fillStyle=f}else o.fillStyle=r.color;o.beginPath(),o.moveTo(h,_);for(let f=0;f<k;(f+=1)-1){const p=Math.round(e[2*f]/V*_);o.lineTo(f*H+h,_-p)}for(let f=k-1;f>=0;(f-=1)+1){const p=Math.round(e[2*f+1]/V*_);o.lineTo(f*H+h,_-p)}o.fill(),o.fillRect(0,_-h,d,h)},M=(o,d,e)=>{o.clearRect(0,0,d,e)};function A(){n(t.canvasWidth,t.canvasHeight,t.peaks)}var x=Gt();E("resize",xt,A),Rt(x,o=>a=o,()=>a),D(i,x),vt()}var Tt=O('<div id="wave-wrapper" style="position: relative; width: 100%; height: 100%; cursor: pointer;"><!> <div class="progress-wave-wrapper svelte-fpz5q5"><!></div></div>');function X(i,t){let a=T(t,"position",3,0),s=T(t,"color",3,"grey"),n=T(t,"progressColor",3,"#8a005e"),c=T(t,"gradientColors",19,()=>[]),y=T(t,"progressGradientColors",19,()=>[]);var b=Tt(),w=v(b);ct(w,{get peaks(){return t.peaks},get barWidth(){return t.barWidth},get color(){return s()},get gradientColors(){return c()},get canvasWidth(){return t.width},get canvasHeight(){return t.height}});var C=g(w,2);const M=St(()=>`width: ${Math.round(t.width*a())??""}px; height: ${t.height??""}px;`);var A=v(C);ct(A,{get peaks(){return t.peaks},get barWidth(){return t.barWidth},get color(){return n()},get gradientColors(){return y()},get canvasWidth(){return t.width},get canvasHeight(){return t.height}}),u(C),u(b),z(()=>Et(C,"style",l(M))),E("click",b,function(x){lt.call(this,t,x)}),E("mousemove",b,function(x){lt.call(this,t,x)}),D(i,b)}var Dt=O('<meta name="description" content="Add stunning, customizable audio waveform visualizations to your Svelte apps. Perfect for music players, podcasts, and more!"> <meta name="keywords" content="Svelte, Audio Waveform, Music Player, Podcast Visualization, Audio Visualization"> <meta name="author" content="https://github.com/Catsvilles/svelte-audio-waveform"> <meta property="og:title" content="Svelte Audio Waveform - Stunning Audio Visualizations"> <meta property="og:description" content="Add stunning, customizable audio waveform visualizations to your Svelte apps. Perfect for music players, podcasts, and more!"> <meta property="og:url" content="https://yourwebsite.com/audio-waveform"> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:title" content="Svelte Audio Waveform - Stunning Audio Visualizations"> <meta name="twitter:description" content="Add stunning, customizable audio waveform visualizations to your Svelte apps. Perfect for music players, podcasts, and more!">',1),Ot=O('<div class="waveform-container svelte-1rygfr4"><h3>Basic Waveform</h3> <!> <div class="controls svelte-1rygfr4"><button class="play-pause-btn svelte-1rygfr4"> </button> <div class="time-display svelte-1rygfr4"> <span class="right-aligned svelte-1rygfr4"> </span></div></div></div> <div class="waveform-container svelte-1rygfr4"><h3>Basic Waveform With Bars</h3> <!> <div class="controls svelte-1rygfr4"><button class="play-pause-btn svelte-1rygfr4"> </button> <div class="time-display svelte-1rygfr4"> <span class="right-aligned svelte-1rygfr4"> </span></div></div></div> <div class="waveform-container svelte-1rygfr4"><h3>Gradient Waveform Color</h3> <!> <div class="controls svelte-1rygfr4"><button class="play-pause-btn svelte-1rygfr4"> </button> <div class="time-display svelte-1rygfr4"> <span class="right-aligned svelte-1rygfr4"> </span></div></div></div> <div class="waveform-container svelte-1rygfr4"><h3>Gradient Progress Color</h3> <!> <div class="controls svelte-1rygfr4"><button class="play-pause-btn svelte-1rygfr4"> </button> <div class="time-display svelte-1rygfr4"> <span class="right-aligned svelte-1rygfr4"> </span></div></div></div>',1),jt=O('<main><h1>Svelte Audio Waveform</h1> <p>Visualize your audio files with stunning waveforms in Svelte. Upload an audio file to see the waveform in action!</p> <p>Check the project with full docs on <a href="https://github.com/Catsvilles/svelte-audio-waveform">https://github.com/Catsvilles/svelte-audio-waveform</a></p> <div class="audio-player svelte-1rygfr4"><input type="file" accept="audio/*" class="file-input svelte-1rygfr4"> <!></div></main>');function Nt(i,t){dt(t,!1);let a=U([]),s=U(0),n,c=U(0),y=U(!1);async function b(d){var h;const e=(h=d.target.files)==null?void 0:h[0];if(!e)return;const r=await Lt(e);B(a,Vt(r,{numberOfBuckets:1200}));const P=URL.createObjectURL(e);n=new Audio(P),n.addEventListener("loadedmetadata",()=>{B(c,n.duration)}),n.addEventListener("timeupdate",()=>{B(s,n.currentTime/n.duration)}),n.addEventListener("play",()=>{B(y,!0)}),n.addEventListener("pause",()=>{B(y,!1)}),n.addEventListener("ended",()=>{B(y,!1),B(s,0)})}function w(d){if(!n)return;const e=d.currentTarget.getBoundingClientRect(),h=(d.pageX-e.left)/e.width*n.duration;n.currentTime=h}function C(){n&&(l(y)?n.pause():n.play())}yt();var M=jt();Pt(d=>{var e=Dt();Mt.title="Svelte Audio Waveform - Stunning Audio Visualizations",At(16),D(d,e)});var A=g(v(M),6),x=v(A),o=g(x,2);Bt(o,()=>l(a).length>0,d=>{var e=Ot(),r=zt(e),P=g(v(r),2);X(P,{barWidth:0,get peaks(){return l(a)},height:100,width:800,get position(){return l(s)},$$events:{click:w}});var h=g(P,2),_=v(h),k=v(_,!0);u(_);var H=g(_,2),V=v(H);z(()=>S(V,`${R(l(s)*l(c))??""} `));var f=g(V),p=v(f,!0);z(()=>S(p,R(l(c)))),u(f),u(H),u(h),u(r);var m=g(r,2),W=g(v(m),2);X(W,{barWidth:4,get peaks(){return l(a)},height:100,width:800,get position(){return l(s)},$$events:{click:w}});var L=g(W,2),G=v(L),ut=v(G,!0);u(G);var F=g(G,2),N=v(F);z(()=>S(N,`${R(l(s)*l(c))??""} `));var J=g(N),ft=v(J,!0);z(()=>S(ft,R(l(c)))),u(J),u(F),u(L),u(m);var q=g(m,2),K=g(v(q),2);X(K,{barWidth:4,get peaks(){return l(a)},height:100,width:800,gradientColors:["#00f260","#0575e6","#ff0084"],get position(){return l(s)},$$events:{click:w}});var Q=g(K,2),j=v(Q),gt=v(j,!0);u(j);var Y=g(j,2),Z=v(Y);z(()=>S(Z,`${R(l(s)*l(c))??""} `));var $=g(Z),ht=v($,!0);z(()=>S(ht,R(l(c)))),u($),u(Y),u(Q),u(q);var tt=g(q,2),et=g(v(tt),2);X(et,{barWidth:4,get peaks(){return l(a)},height:100,width:800,progressGradientColors:["#00f260","#0575e6","#ff0084"],get position(){return l(s)},$$events:{click:w}});var at=g(et,2),I=v(at),mt=v(I,!0);u(I);var rt=g(I,2),it=v(rt);z(()=>S(it,`${R(l(s)*l(c))??""} `));var nt=g(it),pt=v(nt,!0);z(()=>S(pt,R(l(c)))),u(nt),u(rt),u(at),u(tt),z(()=>{S(k,l(y)?"⏸️":"▶️"),S(ut,l(y)?"⏸️":"▶️"),S(gt,l(y)?"⏸️":"▶️"),S(mt,l(y)?"⏸️":"▶️")}),E("click",_,C),E("click",G,C),E("click",j,C),E("click",I,C),D(d,e)}),u(A),u(M),E("change",x,b),D(i,M),vt()}export{Nt as component};
